<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>테일즈런너 트레이닝 트래커</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1>TR TRACKER</h1>
            </div>

            <div class="toggle-wrapper">
                <div class="toggle-switch active" id="autoDetectToggle">
                    <div class="toggle-knob"></div>
                </div>
                <span>AUTO GOAL 감지</span>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-label">Total Time</div>
                    <div class="stat-value" id="sessionTimer">00:00:00</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Completed</div>
                    <div class="stat-value" id="completionStats">0 / 0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Today</div>
                    <div class="stat-value" id="todayStats">0판</div>
                </div>
            </div>

            <div class="header-actions">
                <button class="btn btn-icon" id="resetAllBtn" title="전체 초기화">
                    <i class="fa-solid fa-rotate-left"></i>
                </button>
                <button class="btn btn-icon" id="settingsBtn" title="설정">
                    <i class="fa-solid fa-gear"></i>
                </button>
            </div>
        </header>

        <!-- 현재 포커스된 맵 표시 -->
        <div class="focus-indicator" id="focusIndicator">
            <div class="focus-label">현재 연습 중</div>
            <div class="focus-map-name" id="focusMapName">-</div>
            <div class="focus-hint">GOAL 감지 시 이 맵의 카운트가 올라갑니다</div>
        </div>

        <!-- Tabs with Timer -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="training">
                트레이닝
                <span class="tab-timer" id="trainingTimer"><i class="fa-solid fa-stopwatch"></i> 00:00</span>
            </button>
            <button class="tab-btn" data-tab="fairytale">
                동화맵
                <span class="tab-timer" id="fairytaleTimer"><i class="fa-solid fa-stopwatch"></i> 00:00</span>
            </button>
            <button class="tab-btn" data-tab="custom">
                기술연습
                <span class="tab-timer" id="customTimer"><i class="fa-solid fa-stopwatch"></i> 00:00</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="map-grid" id="mapGrid">
            <div class="loading-placeholder">
                <i class="fa-solid fa-spinner fa-spin"></i>
                <span>로딩 중...</span>
            </div>
        </main>

        <!-- 맵 추가 버튼 -->
        <button class="add-map-btn" id="addMapBtn">
            <i class="fa-solid fa-plus"></i>
            <span>맵 추가</span>
        </button>

        <!-- 맵 추가 모달 -->
        <div class="modal-overlay" id="addMapModal">
            <div class="modal-content">
                <h2>새 연습 항목 추가</h2>
                <input type="text" id="newMapName" placeholder="맵 또는 기술 이름" maxlength="30">
                <select id="newMapCategory">
                    <option value="training">트레이닝</option>
                    <option value="fairytale">동화맵</option>
                    <option value="custom">기술연습</option>
                </select>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelAddMap">취소</button>
                    <button class="btn btn-primary" id="confirmAddMap">추가</button>
                </div>
            </div>
        </div>

        <!-- 설정 모달 -->
        <div class="modal-overlay" id="settingsModal">
            <div class="modal-content">
                <h2><i class="fa-solid fa-gear"></i> 설정</h2>

                <div class="settings-group">
                    <label class="settings-label">기본 목표 횟수</label>
                    <div class="settings-row">
                        <input type="number" id="defaultTargetCount" min="1" max="99" value="5">
                        <span>판</span>
                    </div>
                </div>

                <div class="settings-group">
                    <label class="settings-label">하루 자동 초기화</label>
                    <div class="settings-row">
                        <div class="toggle-switch" id="dailyResetToggle">
                            <div class="toggle-knob"></div>
                        </div>
                        <span>매일 자정에 진행도 초기화</span>
                    </div>
                </div>

                <div class="settings-group">
                    <label class="settings-label">오늘 완주 기록</label>
                    <div class="settings-value" id="todayCompletedValue">0판</div>
                </div>

                <div class="modal-actions">
                    <button class="btn btn-secondary" id="closeSettings">닫기</button>
                    <button class="btn btn-primary" id="saveSettings">저장</button>
                </div>
            </div>
        </div>

        <!-- 목표 횟수 수정 모달 -->
        <div class="modal-overlay" id="editTargetModal">
            <div class="modal-content">
                <h2>목표 횟수 수정</h2>
                <p id="editTargetMapName" style="color: var(--text-secondary); margin-bottom: 1rem;"></p>
                <input type="number" id="editTargetValue" min="1" max="99" value="5">
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelEditTarget">취소</button>
                    <button class="btn btn-primary" id="confirmEditTarget">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toastContainer"></div>

    <script src="app.js"></script>
</body>

</html>